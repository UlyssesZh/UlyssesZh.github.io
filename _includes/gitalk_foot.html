{%- unless layout.no_gitalk -%}{%- unless page.no_gitalk -%}{%- if jekyll.environment == 'production' or site.gitalk.enable_in_development -%}
	<script>
		let gitalkId = location.pathname;
		if (gitalkId.endsWith('/index.html')) {
			gitalkId = gitalkId.substring(0, gitalkId.length - 'index.html'.length);
		}
		if (/\/page\/\d+\/$/.test(gitalkId)) {
			gitalkId = gitalkId.replace(/\/page\/\d+\/$/, '/');
		}
		const gitalk = new Gitalk({
			clientID: '{{ site.gitalk.client_id }}',
			clientSecret: '{{ site.gitalk.client_secret }}',
			repo: '{{ site.gitalk.repo }}',
			owner: '{{ site.gitalk.owner }}',
			admin: ['{{ site.gitalk.admin | join: "','" }}'],
			id: gitalkId,
			distractionFreeMode: false,
			language: document.documentElement.lang
		})
		gitalk.render('gitalk-container')
	</script>
{%- endif -%}{%- endunless -%}{%- endunless -%}
